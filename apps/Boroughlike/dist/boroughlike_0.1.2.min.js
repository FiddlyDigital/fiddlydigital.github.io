const e={Heal:[0,0],Flame:[1,0],Bolt_Horizontal:[2,0],Bolt_Vertical:[3,0]},t="AssetsLoaded",s="KeyPress",i="PlayerLose",r="PlayerWin",n="GameOver",a="GameWin",o="Loading",l="Running",h="Title",c=[0,0],p={Player:[0,0],Player_Dead:[1,0],Bird:[2,0],Snake:[3,0],Tank:[4,0],Eater:[5,0],Jester:[6,0],HP:[7,0],MonsterLoad:[8,0],Turret_N:[9,0],Turret_E:[10,0],Turret_S:[11,0],Turret_W:[12,0]},d={BOOK:"book.wav",MONSTERHIT:"hit2.wav",NEWLEVEL:"newLevel.wav",PLAYERHIT:"hit1.wav",SPELL:"spell.wav"},u="effect",f="item",m="Monster",g="tile",S={Floor:[0,0],StairDown:[1,0],StairUp:[1,1],SpikePit:[2,0],FountainActive:[3,0],FountainInactive:[3,1],Wall:[0,2],Wall_L:[1,2],Wall_R:[2,2],Wall_LR:[3,2],Wall_T:[0,3],Wall_B:[1,3],Wall_TB:[2,3],Wall_LT:[3,3],Wall_RT:[0,4],Wall_LRT:[1,4],Wall_LB:[2,4],Wall_RB:[3,4],Wall_LRB:[0,5],Wall_LTB:[1,5],Wall_RTB:[2,5],Wall_LRTB:[3,5],Floor:[0,6],Floor_L:[1,6],Floor_R:[2,6],Floor_LR:[3,6],Floor_T:[0,7],Floor_B:[1,7],Floor_TB:[2,7],Floor_LT:[3,7],Floor_RT:[0,8],Floor_LRT:[1,8],Floor_LB:[2,8],Floor_RB:[3,8],Floor_LRB:[0,9],Floor_LTB:[1,9],Floor_RTB:[2,9],Floor_LRTB:[3,9]};class y{constructor(){if(!y.instance){this.sounds={};for(let[e,t]of Object.entries(d))this.sounds[t]=null;y.instance=this}return y.instance}initSounds(){for(let[e,t]of Object.entries(d))this.sounds[t]=new Audio(`assets/sounds/${t}`)}playSound(e){e&&this.sounds[e]&&(this.sounds[e].currentTime=0,this.sounds[e].play())}}const v=new y;Object.freeze(v);class b{constructor(e,t){this.stateMatrix=e,this.currentState={name:""},this.previousState=null,this.enterState(t)}triggerEvent(e){let t=this.currentState.getNewState(e);t&&this.enterState(t)}enterState(e){e!==this.currentState.name&&(this.currentState.onExit&&this.currentState.onExit(),this.previousState=this.currentState,this.currentState=this.stateMatrix[e],this.currentState.onEnter&&this.currentState.onEnter())}}class w{constructor(e,t,s,i){this.name=e||"",this.transformations=t||{},this.onEnter=s,this.onExit=i}getNewState(e){return e=e||"",!!this.transformations[e]&&this.transformations[e]}}class T{static tryTo(e,t){for(let e=1e3;e>0;e--)if(t())return;throw"Timeout while trying to "+e}static randomRange(e,t){return Math.floor(Math.random()*(t-e+1))+e}static shuffle(e){let t,s;for(let i=1;i<e.length;i++)s=T.randomRange(0,i),t=e[i],e[i]=e[s],e[s]=t;return e}static rightPad(e){let t="";return e.forEach(e=>{for(let t=(e+="").length;t<10;t++)e+=" ";t+=e}),t}}class k{constructor(){return k.instance||(this.monsterSpriteSheet=new Image,this.tileSpriteSheet=new Image,this.effectSpriteSheet=new Image,this.itemSpriteSheet=new Image,this.callback={onLoadCompleted:null},this.playerLocationElem=document.getElementById("playerLocation"),this.playerBooksElem=document.getElementById("playerBooks"),this.shake={amount:0,x:0,y:0},this.canvas=document.querySelector("canvas"),this.ctx=this.canvas.getContext("2d"),k.instance=this),k.instance}initSpriteSheet(e){this.callback.onLoadCompleted=e,this.monsterSpriteSheet.onload=this.checkAllSpriteSheetsLoaded.bind(this),this.tileSpriteSheet.onload=this.checkAllSpriteSheetsLoaded.bind(this),this.effectSpriteSheet.onload=this.checkAllSpriteSheetsLoaded.bind(this),this.itemSpriteSheet.onload=this.checkAllSpriteSheetsLoaded.bind(this),this.monsterSpriteSheet.src="assets/images/monsters.png",this.tileSpriteSheet.src="assets/images/library_new.png",this.effectSpriteSheet.src="assets/images/effects.png",this.itemSpriteSheet.src="assets/images/items.png"}checkAllSpriteSheetsLoaded(){this.monsterSpriteSheet.complete&&this.tileSpriteSheet.complete&&this.effectSpriteSheet.complete&&this.itemSpriteSheet.complete&&this.callback.onLoadCompleted()}setupCanvas(){this.canvas.width=768,this.canvas.height=768,this.canvas.style.width=this.canvas.width+"px",this.canvas.style.height=this.canvas.height+"px",this.ctx.imageSmoothingEnabled=!1,this.ctx.font="consolas, monospace"}getSpriteSheet(e){switch(e){case m:return this.monsterSpriteSheet;case g:return this.tileSpriteSheet;case u:return this.effectSpriteSheet;case f:return this.itemSpriteSheet}}drawSprite(e,t,s,i,r){e===u&&r&&r>0&&(this.ctx.globalAlpha=r/30),this.ctx.drawImage(this.getSpriteSheet(e),16*t[0],16*t[1],16,16,64*s+this.shake.x,64*i+this.shake.y,64,64),e===u&&(!r||r<=0)&&(this.ctx.globalAlpha=1)}clearCanvas(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)}screenshake(){this.shake.amount&&this.shake.amount--;let e=Math.random()*Math.PI*2;this.shake.x=Math.round(Math.cos(e)*this.shake.amount),this.shake.y=Math.round(Math.sin(e)*this.shake.amount)}drawDarkBackground(){this.clearCanvas(),this.ctx.fillStyle="rgba(0,0,0,.75)",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height)}hideOverlays(){var e=document.getElementsByClassName("overlay");for(let t=0;t<e.length;t++)e[t].style.display="none"}showTitle(e){var t=document.getElementById("TitleOverlay");e&&e.length>0&&this.drawScores(e),t.style.display="block"}showGameWin(e){var t=document.getElementById("GameWinOverlay");e&&e.length>0&&this.drawScores(e),t.style.display="block"}showGameLose(e){var t=document.getElementById("GameLoseOverlay");e&&e.length>0&&this.drawScores(e),t.style.display="block"}updateSidebar(e,t,s){this.playerBooksElem.innerText=t,this.playerLocationElem.innerText=e;for(var i=document.getElementById("spells");i.hasChildNodes();)i.removeChild(i.firstChild);let r=document.createDocumentFragment();for(let e=0;e<s.length;e++){let t=document.createElement("button");t.className="spellButton",t.innerText="("+(e+1)+") "+(s[e]||""),t.addEventListener("click",(function(){Y.handleInteraction({key:""+(e+1)})})),r.append(t)}i.appendChild(r)}drawScores(e){let t=e.pop();e.sort((function(e,t){return t.totalScore-e.totalScore})),e.unshift(t);var s=document.getElementsByClassName("scores");for(let t=0;t<s.length;t++){let i=s[t].children[1];for(;i.hasChildNodes();)i.removeChild(i.firstChild);let r=new DocumentFragment;for(let t=0;t<Math.min(10,e.length);t++){let s=document.createElement("tr"),i=document.createElement("td"),n=document.createElement("td"),a=document.createElement("td");i.innerHTML=e[t].run,n.innerHTML=e[t].score,a.innerHTML=e[t].totalScore,s.appendChild(i),s.appendChild(n),s.appendChild(a),r.appendChild(s)}i.appendChild(r)}}setShakeAmount(e){this.shake.amount=e}}const E=new k;Object.freeze(E);class L{constructor(e,t,s,i){this.x=e,this.y=t,this.sprite=s,this.passable=i}dist(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}getNeighbor(e,t){return U.getTile(this.x+e,this.y+t)}getAdjacentNeighbors(){return[this.getNeighbor(0,-1),this.getNeighbor(0,1),this.getNeighbor(-1,0),this.getNeighbor(1,0)]}getNeighbourChain(e){let t=[0,0];switch(e){case"N":t=[0,-1];break;case"S":t=[0,1];break;case"E":t=[1,0];break;case"W":t=[-1,0]}let s=[],i=this;for(;null!=i;)i=i.getNeighbor(t[0],t[1]),i instanceof x?i=null:s.push(i);return s}getAdjacentPassableNeighbors(){return this.getAdjacentNeighbors().filter(e=>e&&e.passable)}getConnectedTiles(){let e=[this],t=[this];for(;t.length;){let s=t.pop().getAdjacentPassableNeighbors().filter(t=>t&&!e.includes(t));e=e.concat(s),t=t.concat(s)}return e}draw(){E.drawSprite(g,this.sprite,this.x,this.y),this.book&&E.drawSprite(f,c,this.x,this.y),this.effectCounter&&(this.effectCounter--,E.drawSprite(u,this.effect,this.x,this.y,this.effectCounter))}setEffect(e){this.effect=e,this.effectCounter=30}}class M extends L{constructor(e,t){super(e,t,S.Floor,!0)}stepOn(e){e.isPlayer&&this.book&&(Y.incrementScore(),this.book=!1)}}class x extends L{constructor(e,t){super(e,t,S.Wall,!1)}}class A extends L{constructor(e,t){super(e,t,S.StairDown,!0)}stepOn(e){e.isPlayer&&Y.nextLevel()}}class P extends L{constructor(e,t){super(e,t,S.SpikePit,!0)}stepOn(e){e.isPlayer&&E.setShakeAmount(5),e.hit(1)}}class B extends L{constructor(e,t){super(e,t,S.FountainActive,!0),this.isActive=!0}stepOn(e){this.isActive&&e.isPlayer&&(this.isActive=!1,this.sprite=S.FountainInactive,e.heal(10))}}const N={WOOP:function(e){e.move(U.randomPassableTile())},QUAKE:function(e){for(let t=0;t<12;t++)for(let s=0;s<12;s++){let i=U.getTile(t,s);if(i&&i.monster&&i.monster!=e){let e=4-i.getAdjacentPassableNeighbors().length;i.monster.hit(2*e)}}E.setShakeAmount(20)},TORNADO:function(){for(let e=0;e<U.getMonsters().length;e++)U.getMonsters()[e].move(U.randomPassableTile()),U.getMonsters()[e].teleportCounter=2},AURA:function(t){t.tile.getAdjacentNeighbors().forEach((function(t){t&&(t.setEffect(e.Heal),t.monster&&t.monster.heal(1))})),t.tile.setEffect(e.Heal),t.heal(3)},DASH:function(t){let s=t.tile;for(;;){let e=s.getNeighbor(t.lastMove[0],t.lastMove[1]);if(!e.passable||e.monster)break;s=e}t.tile!=s&&(t.move(s),s.getAdjacentNeighbors().forEach(t=>{t&&t.monster&&(t.setEffect(e.Flame),t.monster.stunned=!0,t.monster.hit(1))}))},FLATTEN:function(t){for(let e=1;e<11;e++)for(let t=1;t<11;t++){let s=U.getTile(e,t);s&&!s.passable&&U.replaceTile(e,t,M)}t.tile.setEffect(e.Flame),t.heal(2)},ALCHEMY:function(e){e.tile.getAdjacentNeighbors().forEach((function(e){if(e&&!e.passable&&U.inBounds(e.x,e.y)){U.replaceTile(e.x,e.y,M);let t=U.getTile(e.x,e.y);t&&(t.book=!0)}}))},POWERATTACK:function(e){e.bonusAttack=5},PROTECT:function(e){e.shield=2;for(let e=0;e<U.getMonsters().length;e++)U.getMonsters()[e].stunned=!0},BOLT:function(e){C(e,e.lastMove,15+Math.abs(e.lastMove[1]),4)},CROSS:function(t){let s=[[0,-1],[0,1],[-1,0],[1,0]];for(let i=0;i<s.length;i++){let r=0==Math.abs(s[i][1])?e.Bolt_Horizontal:e.Bolt_Vertical;C(t,s[i],r,2)}},EX:function(t){let s=[[-1,-1],[-1,1],[1,-1],[1,1]];for(let i=0;i<s.length;i++)C(t,s[i],e.Flame,3)}};function C(e,t,s,i){let r=e.tile;for(;;){let e=r.getNeighbor(t[0],t[1]);if(!e.passable)break;r=e,r.monster&&r.monster.hit(i),r.setEffect(s)}}class _{constructor(e,t,s){this.move(e),this.sprite=t,this.hp=s,this.teleportCounter=2,this.offsetX=0,this.offsetY=0,this.lastMove=[-1,0],this.bonusAttack=0}heal(e){this.hp=Math.min(6,this.hp+e),this.isPlayer}update(){this.teleportCounter--,this.stunned||this.teleportCounter>0?this.stunned=!1:this.doStuff()}doStuff(){let e=this.tile.getAdjacentPassableNeighbors();e=e.filter(e=>e&&(!e.monster||e.monster.isPlayer));let t=Y.getPlayerTile();if(e.length){e.sort((e,s)=>e.dist(t)-s.dist(t));let s=e[0];this.tryMove(s.x-this.tile.x,s.y-this.tile.y)}}getDisplayX(){return this.tile.x+this.offsetX}getDisplayY(){return this.tile.y+this.offsetY}draw(){this.teleportCounter>0?E.drawSprite(m,p.MonsterLoad,this.getDisplayX(),this.getDisplayY()):(E.drawSprite(m,this.sprite,this.getDisplayX(),this.getDisplayY()),this.drawHp()),this.offsetX-=Math.sign(this.offsetX)*(1/8),this.offsetY-=Math.sign(this.offsetY)*(1/8)}drawHp(){for(let e=0;e<this.hp;e++)E.drawSprite(m,p.HP,this.getDisplayX()+e%3*(5/16),this.getDisplayY()-Math.floor(e/3)*(5/16))}tryMove(e,t){let s=this.tile.getNeighbor(e,t);if(s&&s.passable)return this.lastMove=[e,t],s.monster?this.isPlayer!=s.monster.isPlayer&&(this.attackedThisTurn=!0,s.monster.stunned=!0,s.monster.hit(1+this.bonusAttack),this.bonusAttack=0,E.setShakeAmount(5),this.offsetX=(s.x-this.tile.x)/2,this.offsetY=(s.y-this.tile.y)/2):this.move(s),!0}hit(e){this.shield>0||(this.hp-=e,this.hp<=0&&(this.die(),this.tile instanceof M&&(this.tile.book=!0)),this.isPlayer?v.playSound(d.PLAYERHIT):v.playSound(d.MONSTERHIT))}die(){this.dead=!0,this.tile.monster=null,this.isPlayer&&(this.sprite=1)}move(e){this.tile&&(this.tile.monster=null,this.offsetX=this.tile.x-e.x,this.offsetY=this.tile.y-e.y),this.tile=e,e.monster=this,e.stepOn(this)}}class R extends _{constructor(e){super(e,p.Player,3),this.isPlayer=!0,this.teleportCounter=0,this.spells=T.shuffle(Object.keys(N)).splice(0,Y.props.numSpells)}update(){this.shield--}tryMove(e,t){super.tryMove(e,t)&&Y.tick()}addSpell(){let e=T.shuffle(Object.keys(N))[0];this.spells.push(e)}castSpell(e){let t=this.spells[e];t&&(this.spells.splice(e,1),N[t](this),v.playSound(d.SPELL),Y.tick())}}class F extends _{constructor(e){super(e,p.Bird,3)}}class I extends _{constructor(e){super(e,p.Snake,1)}doStuff(){this.attackedThisTurn=!1,super.doStuff(),this.attackedThisTurn||super.doStuff()}}class O extends _{constructor(e){super(e,p.Tank,2)}update(){let e=this.stunned;super.update(),e||(this.stunned=!0)}}class W extends _{constructor(e){super(e,p.Eater,1)}doStuff(){let e=this.tile.getAdjacentNeighbors().filter(e=>e&&!e.passable&&U.inBounds(e.x,e.y));e.length?(U.replaceTile(e[0].x,e[0].y,M),this.heal(.5)):super.doStuff()}}class D extends _{constructor(e){super(e,p.Jester,2)}doStuff(){let e=T.shuffle(this.tile.getAdjacentPassableNeighbors());e.length&&this.tryMove(e[0].x-this.tile.x,e[0].y-this.tile.y)}}class H extends _{constructor(e){super(e,p.Turret,1),this.directions=["N","E","S","W"],this.currentDirection=T.randomRange(0,3)}doStuff(){this.currentDirection+=1,4==this.currentDirection&&(this.currentDirection=0);let t=this.directions[this.currentDirection];this.sprite=p["Turret_"+t];var s=this.tile.getNeighbourChain(t);s.some(e=>e&&e.monster&&e.monster.isPlayer)&&s.forEach(s=>{if(s)switch(s.monster&&s.monster.hit(1),t){case"N":case"S":s.setEffect(e.Bolt_Vertical);break;case"E":case"W":s.setEffect(e.Bolt_Horizontal)}})}}class j{constructor(){return j.instance||(this.props={monsters:[],tiles:[],level:1},j.instance=this),j.instance}replaceTile(e,t,s){return this.props.tiles[e][t]=new s(e,t),this.props.tiles[e][t]}tiles(){return this.props.tiles}getMonsters(){return this.props.monsters}generateLevel(e){this.props.level=e,T.tryTo("generate map",(function(){return U.generateTiles()==U.randomPassableTile().getConnectedTiles().length})),this.generateMonsters();for(var t=0;t<3;){let e=this.randomPassableTile();e instanceof M&&(t++,e.book=!0)}}generateTiles(){let e=0;this.props.tiles=[];for(let t=0;t<12;t++){this.props.tiles[t]=[];for(let s=0;s<12;s++)0==t||0==s||11==t||11==s||Math.random()<.3?this.props.tiles[t][s]=new x(t,s):(Math.random()<.02?this.props.tiles[t][s]=new P(t,s):Math.random()<.005?this.props.tiles[t][s]=new B(t,s):this.props.tiles[t][s]=new M(t,s),e++)}for(let e=0;e<12;e++)for(let t=0;t<12;t++){let s=this.props.tiles[t][e];if(s instanceof x){let e=s.getAdjacentNeighbors();if(e&&e.length>0){let t=this.getSpriteVariationSuffixForTile(e,x);t&&(s.sprite=S["Wall_"+t])}}}return e}getSpriteVariationSuffixForTile(e,t){let s="";return e[2]&&e[2]instanceof t&&(s+="L"),e[3]&&e[3]instanceof t&&(s+="R"),e[0]&&e[0]instanceof t&&(s+="T"),e[1]&&e[1]instanceof t&&(s+="B"),s}inBounds(e,t){return e>=0&&t>=0&&e<12&&t<12}getTile(e,t){return this.inBounds(e,t)?this.props.tiles[e][t]:null}randomPassableTile(){let e;return T.tryTo("get random passable tile",(function(){let t=T.randomRange(0,11),s=T.randomRange(0,11);return e=U.getTile(t,s),e&&e.passable&&!e.monster})),e}generateMonsters(){this.props.monsters=[];let e=Math.ceil(this.props.level/2)+1;for(let t=0;t<e;t++)this.spawnMonster()}spawnMonster(){let e=new(0,T.shuffle([F,I,O,W,D,H])[0])(this.randomPassableTile());this.props.monsters.push(e)}}const U=new j;Object.freeze(U);class G{constructor(){if(!G.instance){this.version="0.1.2",this.props={level:1,numSpells:1,player:null,score:0,spawnCounter:0,spawnRate:15};const e={};e[o]=new w(o,{AssetsLoaded:h},this.loadAssets),e[h]=new w(h,{KeyPress:l},this.showTitle.bind(this)),e[l]=new w(l,{PlayerLose:n,PlayerWin:a},this.startGame.bind(this)),e[n]=new w(n,{KeyPress:h},this.showGameLose.bind(this)),e[a]=new w(a,{KeyPress:h},this.showGameWin.bind(this)),this.FSM=new b(e,o),G.instance=this}return G.instance}init(){E.setupCanvas(),this.addEventHandlers(),setInterval(this.draw.bind(this),15)}loadAssets(){v.initSounds(),E.initSpriteSheet((function(){Y.FSM.triggerEvent(t)}))}addEventHandlers(){document.querySelector("html").onkeydown=Y.handleInteraction,window.addEventListener("touchstart",(function(){Y.handleInteraction(null)})),window.addEventListener("mousedown",(function(){Y.handleInteraction(null)})),document.getElementById("moveUp").addEventListener("click",(function(){Y.handleInteraction({key:"Up"})})),document.getElementById("moveDown").addEventListener("click",(function(){Y.handleInteraction({key:"Down"})})),document.getElementById("moveLeft").addEventListener("click",(function(){Y.handleInteraction({key:"Left"})})),document.getElementById("moveRight").addEventListener("click",(function(){Y.handleInteraction({key:"Right"})})),document.getElementById("movePass").addEventListener("click",(function(){Y.handleInteraction({key:" "})}))}handleInteraction(e){switch(Y.FSM.currentState.name){case o:break;case l:e&&Y.handleKeypress(e);break;default:Y.FSM.triggerEvent(s)}}handleKeypress(e){if(!(e=e||window.event).defaultPrevented)switch(e.key){case"Up":case"ArrowUp":case"w":case"W":this.props.player.tryMove(0,-1);break;case"Down":case"ArrowDown":case"s":case"S":this.props.player.tryMove(0,1);break;case"Left":case"ArrowLeft":case"a":case"A":this.props.player.tryMove(-1,0);break;case"Right":case"ArrowRight":case"d":case"D":this.props.player.tryMove(1,0);break;case" ":this.props.player.tryMove(0,0);break;case 1:case"1":case 2:case"2":case 3:case"3":case 4:case"4":case 5:case"5":case 6:case"6":case 7:case"7":case 8:case"8":case 9:case"9":this.props.player.castSpell(parseInt(e.key)-1),this.props.sidebarNeedsUpdate=!0}}draw(){if(this.FSM.currentState.name==l){E.clearCanvas(),E.screenshake();for(let e=0;e<12;e++)for(let t=0;t<12;t++)U.getTile(e,t).draw();for(let e=0;e<U.getMonsters().length;e++)U.getMonsters()[e].draw();this.props.player.draw(),this.props.sidebarNeedsUpdate&&(this.props.sidebarNeedsUpdate=!1,E.updateSidebar(this.props.level,this.props.score,this.props.player.spells))}}tick(){if(this.FSM.currentState.name==l){for(let e=U.getMonsters().length-1;e>=0;e--)U.getMonsters()[e].dead?U.getMonsters().splice(e,1):U.getMonsters()[e].update();this.props.player.update(),this.props.player.dead&&(this.addScore(this.props.score,!1),this.props.sidebarNeedsUpdate=!0,this.FSM.triggerEvent(i)),this.props.spawnCounter--,this.props.spawnCounter<=0&&(U.spawnMonster(),this.props.spawnCounter=this.props.spawnRate,this.props.spawnRate--)}}showTitle(){E.showTitle(this.getScores())}showGameWin(){this.addScore(this.props.score,!0),E.showGameWin(this.props.scores)}showGameLose(){this.addScore(this.props.score,!0),E.showGameLose(this.props.scores)}startGame(){E.hideOverlays(),this.props.level=1,this.props.score=0,this.props.numSpells=1,this.startLevel(3),this.props.sidebarNeedsUpdate=!0}startLevel(e,t){this.props.spawnRate=15,this.props.spawnCounter=this.props.spawnRate,U.generateLevel(this.props.level),this.props.player=new R(U.randomPassableTile()),this.props.player.hp=e,t&&(this.props.player.spells=t);let s=U.randomPassableTile();U.replaceTile(s.x,s.y,A),this.props.sidebarNeedsUpdate=!0}addScore(e,t){let s=this.getScores(),i={score:e,run:1,totalScore:e,active:t},r=s.pop();r&&(r.active?(i.run=r.run+1,i.totalScore+=r.totalScore):s.push(r)),s.push(i),localStorage.scores=JSON.stringify(s)}getScores(){return localStorage.scores?JSON.parse(localStorage.scores):[]}nextLevel(){10==this.props.level?this.FSM.triggerEvent(r):(v.playSound(d.NEWLEVEL),this.props.level++,this.startLevel(Math.min(6,this.props.player.hp+1)),this.props.sidebarNeedsUpdate=!0)}incrementScore(){v.playSound(d.BOOK),this.props.score++,this.props.score%3==0&&this.props.numSpells<9&&(this.props.numSpells++,this.props.player.addSpell()),U.spawnMonster(),this.props.sidebarNeedsUpdate=!0}getPlayerTile(){return this.props.player.tile}}const Y=new G;Object.freeze(Y);export default Y;
